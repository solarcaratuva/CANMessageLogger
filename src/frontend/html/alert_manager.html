{% extends "generic.html" %}
{% block title %}Alert Manager{% endblock %}

{% block head_extra %}
<link rel="stylesheet" href="/static/style/alert_manager.css">
{% endblock %}

{% block content %}

<div class="container-fluid mt-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2>Alert Manager</h2>
    <button class="btn btn-primary" id="addAlertBtn">
      <i class="fa fa-plus mr-2"></i> Add Alert
    </button>
  </div>

  <!-- Main Content - Side by Side Boxes -->
  <div class="row">
    <!-- Active Alerts Box -->
    <div class="col-md-6">
      <div class="card">
        <div class="card-header bg-primary text-white">
          <h4 class="mb-0">Active Alerts</h4>
        </div>
        <div class="card-body alert-section" id="activeAlertsContainer">
          <!-- Will be populated dynamically -->
        </div>
      </div>
    </div>

    <!-- Alert History Box -->
    <div class="col-md-6">
      <div class="card">
        <div class="card-header bg-secondary text-white">
          <h4 class="mb-0">Alert History</h4>
        </div>
        <div class="card-body alert-section" id="alertHistoryContainer">
          <!-- All triggered alerts go here in a single table -->
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div
  class="modal fade"
  id="addAlertModal"
  tabindex="-1"
  role="dialog"
  aria-labelledby="addAlertModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">

      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title" id="addAlertModalLabel">Add Alert</h5>
        <button
          type="button"
          class="close text-white"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <div class="modal-body">
        <!-- Step 1: Choose Alert Type -->
        <div id="step1">
          <form id="alertForm">
            <div class="form-group">
              <label for="alertType"><strong>Alert Type:</strong></label>
              <div id="radioGroup" class="mt-2">
                <!-- Will be populated dynamically -->
              </div>
            </div>
          </form>
        </div>

        <div id="step2" style="display: none;">
          <h5 id="selectedField" class="mb-3 p-2 bg-light"></h5>

          <!-- NAME field -->
          <div class="form-group">
            <label for="alertName"><strong>Alert Name</strong></label>
            <input
              type="text"
              class="form-control"
              id="alertName"
              placeholder="Enter a descriptive name for this alert"
            />
          </div>

          <!-- Boolean-specific options -->
          <div class="form-group" id="boolOptions" style="display: none;">
            <label><strong>Choose a value:</strong></label>
            <div class="form-check">
              <input
                type="radio"
                class="form-check-input"
                name="boolValue"
                id="boolTrue"
                value="true"
              />
              <label class="form-check-label" for="boolTrue">True</label>
            </div>
            <div class="form-check">
              <input
                type="radio"
                class="form-check-input"
                name="boolValue"
                id="boolFalse"
                value="false"
              />
              <label class="form-check-label" for="boolFalse">False</label>
            </div>
          </div>

          <!-- Numeric-specific options -->
          <div class="form-group" id="numericOptions" style="display: none;">
            <label><strong>Enter threshold condition(s):</strong></label>
            
            <div class="form-row align-items-center mb-2">
              <div class="col-auto">
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    id="lessThanCheck"
                    value="<"
                  />
                  <label class="form-check-label" for="lessThanCheck">&lt;</label>
                </div>
              </div>
              <div class="col">
                <input
                  type="number"
                  class="form-control"
                  id="lessThanValue"
                  placeholder="Value"
                />
              </div>
            </div>

            <div class="form-row align-items-center mb-2">
              <div class="col-auto">
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    id="greaterThanCheck"
                    value=">"
                  />
                  <label class="form-check-label" for="greaterThanCheck">&gt;</label>
                </div>
              </div>
              <div class="col">
                <input
                  type="number"
                  class="form-control"
                  id="greaterThanValue"
                  placeholder="Value"
                />
              </div>
            </div>

            <div class="form-row align-items-center mb-2">
              <div class="col-auto">
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    id="equalCheck"
                    value="=="
                  />
                  <label class="form-check-label" for="equalCheck">==</label>
                </div>
              </div>
              <div class="col">
                <input
                  type="number"
                  class="form-control"
                  id="equalValue"
                  placeholder="Value"
                />
              </div>
            </div>

            <div class="form-row align-items-center">
              <div class="col-auto">
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    id="notEqualCheck"
                    value="!="
                  />
                  <label class="form-check-label" for="notEqualCheck">!=</label>
                </div>
              </div>
              <div class="col">
                <input
                  type="number"
                  class="form-control"
                  id="notEqualValue"
                  placeholder="Value"
                />
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-secondary"
          id="backBtn"
          style="display: none;"
        >
          Back
        </button>
        <button type="button" class="btn btn-primary" id="nextBtn">
          Next
        </button>
        <button
          type="button"
          class="btn btn-success"
          id="submitBtn"
          style="display: none;"
        >
          Submit
        </button>
      </div>

    </div>
  </div>
</div>

<!-- Scripts (Popper, Bootstrap JS, any custom) -->
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script src="/static/js/alert_manager.js"></script>

{% endblock %}
